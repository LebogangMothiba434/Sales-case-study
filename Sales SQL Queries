SELECT DATES, 
ROUND(SUM(SALES)/ SUM(QUANTITY_SOLD),0) AS DAILY_PRICE_PER_UNIT
FROM SALES_LM
GROUP BY DATES;
--Q2
SELECT 
SALES,
COST_OF_SALES,
QUANTITY_SOLD
ROUND(SUM(SALES) - SUM(COST_OF_SALES), 0) AS REVENUE,
REVENUE/(SUM(QUANTITY_SOLD)
FROM SALES_LM;

SELECT 
    SALES,
    COST_OF_SALES,
    QUANTITY_SOLD,
    ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(QUANTITY_SOLD), 2) AS REVENUE_PER_UNIT
FROM SALES_LM
GROUP BY SALES, COST_OF_SALES,QUANTITY_SOLD ;
--Q3
SELECT 
DATES,
SALES,
COST_OF_SALES
ROUND((SUM(SALES)-SUM(COST_OF_SALES))/SUM(SALES)*100,2) AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;

SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(SALES) * 100, 2) AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;
SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    TO_VARCHAR(ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(SALES) * 100, 2)) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;

SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    TO_VARCHAR(ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(SALES) * 100, 2)) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;


SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(SALES) * 100, 2) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;
--Q4
SELECT
DATES,
SUM(SALES)AS TOTAL_SALES,
SUM(QUANTITY_SOLD)AS TOTAL_QUANTITY_SOLD,
ROUND((SUM(SALES)/SUM(QUANTITY_SOLD)*100,2)|| '%' AS DAILY_PERCENTAGE_GROSS_PROFIT PER_UNIT
FROM SALES_LM
GROUP BY DATES;

SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(QUANTITY_SOLD) AS TOTAL_QUANTITY_SOLD,
    ROUND(SUM(SALES) / SUM(QUANTITY_SOLD), 2) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT_PER_UNIT
FROM SALES_LM
GROUP BY DATES;

SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    SUM(QUANTITY_SOLD) AS TOTAL_QUANTITY_SOLD,
    ROUND(((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(QUANTITY_SOLD)) * 100, 2) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT_PER_UNIT
FROM SALES_LM
GROUP BY DATES;
--Q5
SELECT 
    DATES, 
    SUM(SALES) AS TOTAL_SALES, 
    SUM(QUANTITY_SOLD) AS TOTAL_QUANTITY_SOLD
FROM SALES_LM
GROUP BY DATES
ORDER BY TOTAL_SALES DESC
LIMIT 3;
--PED
WITH TopSales AS (
    SELECT 
        DATES, 
        SUM(SALES) AS TOTAL_SALES, 
        SUM(QUANTITY_SOLD) AS TOTAL_QUANTITY_SOLD,
        (SUM(SALES) / SUM(QUANTITY_SOLD)) AS PRICE_PER_UNIT
    FROM SALES_LM
    GROUP BY DATES
    ORDER BY TOTAL_SALES DESC
    LIMIT 3
)

SELECT 
    T1.DATES AS PERIOD_1, 
    T2.DATES AS PERIOD_2,
    ROUND(((T2.TOTAL_QUANTITY_SOLD - T1.TOTAL_QUANTITY_SOLD) / T1.TOTAL_QUANTITY_SOLD) * 100, 2) AS PERCENT_CHANGE_QUANTITY,
    ROUND(((T2.PRICE_PER_UNIT - T1.PRICE_PER_UNIT) / T1.PRICE_PER_UNIT) * 100, 2) AS PERCENT_CHANGE_PRICE,
    ROUND(
        (((T2.TOTAL_QUANTITY_SOLD - T1.TOTAL_QUANTITY_SOLD) / T1.TOTAL_QUANTITY_SOLD) * 100) /
        (((T2.PRICE_PER_UNIT - T1.PRICE_PER_UNIT) / T1.PRICE_PER_UNIT) * 100),
        2
    ) AS PRICE_ELASTICITY_DEMAND
FROM TopSales T1
JOIN TopSales T2
ON T1.DATES < T2.DATES
ORDER BY PERIOD_1;
SELECT 
    DATES,
    ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(QUANTITY_SOLD), 2) AS AVERAGE_UNIT_SALES_PRICE
FROM SALES_LM
GROUP BY DATES;

SELECT 
    DATES,
    SUM(SALES) AS TOTAL_SALES,
    SUM(COST_OF_SALES) AS TOTAL_COST_OF_SALES,
    TO_VARCHAR(ROUND((SUM(SALES) - SUM(COST_OF_SALES)) / SUM(SALES) * 100, 2)) || '%' AS DAILY_PERCENTAGE_GROSS_PROFIT
FROM SALES_LM
GROUP BY DATES;

